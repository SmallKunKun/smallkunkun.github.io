# ä»»åŠ¡åç§°ï¼šä»»æ„
name: Deploy Blog Pages

# è§¦å‘æ¡ä»¶
on:
  # pushï¼Œä¹Ÿå°±æ˜¯æ¨é€åˆ°ä»“åº“æ—¶æ‰æ‰§è¡Œä»»åŠ¡
  push:
    # åˆ†æ”¯ï¼Œè¿™é‡Œé€‰æ‹© mainï¼Œä¹Ÿå°±æ˜¯åªæœ‰æ¨é€åˆ° main åˆ†æ”¯æ—¶æ‰æ‰§è¡Œä»»åŠ¡ã€å¯é€‰ã€‘
    branches:
      - main

# ä»»åŠ¡
jobs:
  # ä»»åŠ¡åç§°ï¼Œä»»æ„
  build-and-deploy:
    # æœåŠ¡å™¨ç¯å¢ƒï¼šæœ€æ–°ç‰ˆ Ubuntu
    runs-on: ubuntu-latest
    steps:
      # æ‹‰å–
      - name: ğŸ“¦ Checkout
        uses: actions/checkout@v2
        
      - name: Setup Node            # å®‰è£… Node ç¯å¢ƒ
        uses: actions/setup-node@v1
        with:
          node-version: "12.3.0"
          
      - name: Hexo Generate         # å®‰è£… Hexo ä¾èµ–å¹¶ä¸”ç”Ÿæˆé™æ€æ–‡ä»¶
        run: |
          npm i
          npm i hexo-renderer-swig
          cd themes/sagiri/
          npm i && npm install --save nprogress
          cd ../../
          npm run clean
          npm run build

      # éƒ¨ç½²åˆ° GitHub Pages
      - name: ğŸš€ Deploy
        uses: JamesIves/github-pages-deploy-action@releases/v4
        with:
          # GitHub çš„ Personal access token
          token: ${{secrets.PAT}}
          # æ›´æ¢ä¸ºè‡ªå·±çš„ <user>/<user>.github.io
          repository-name: SmallKunKun/SmallKunKun.github.io
          # è¦éƒ¨ç½²åˆ°çš„åˆ†æ”¯
          branch: gh-pages
          # ä¸Šä¸€æ­¥ç”Ÿæˆçš„é™æ€æ–‡ä»¶çš„åœ°å€
          folder: public
